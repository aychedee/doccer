<html>
<head>
    <title>Doccer</title>
    <script>

function loadXMLDoc() {
    'use strict';
    var xmlhttp;

    if (window.XMLHttpRequest) {
        // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp = new XMLHttpRequest();
    } else {
        // code for IE6, IE5
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }

    xmlhttp.onreadystatechange = function() {
        if (xmlhttp.readyState == 4 ) {
           if(xmlhttp.status == 200){
               var docs = document.getElementById("documents");
               var resp = JSON.parse(xmlhttp.responseText);
               console.log(resp);
               for (var i=0; i < resp.length; i++) {
                   var link = document.createElement('a');
                   link.setAttribute('href', '/doc/' + resp[i].encoded);
                   var el = document.createElement('button');
                   link.appendChild(el);
                   el.innerText = resp[i].name;
                   el.id = resp[i].hash;
                   docs.appendChild(link);

                   console.log(resp[i]);
               }
           }
           else if(xmlhttp.status == 400) {
              alert('There was an error 400')
           }
           else {
               alert('something else other than 200 was returned')
           }
        }
    }

    window.saveFunc = function() {
        var i = document.getElementById('contentInput');
        var el = document.getElementById('content');
        i.value = el.innerText;
        document.getElementById('saveForm').submit();

    };

    xmlhttp.open("GET", "/docs/", true);
    xmlhttp.send();
}

loadXMLDoc();

    </script>
</head>
<body>
<div id="documents"></div>

<div contenteditable id="content" style="font-family: monospace; font-size: 28px;">
    {{.Content}}
</div>

<form id="saveForm" action="/save" method="POST">
    <input type=hidden name="name" value="{{.Name}}"></input>
    <input id="contentInput" type=hidden name="content" value=""></input>
</form>
    <button value="Save document" onclick="saveFunc()">Save Current Point</button>
<form action="/new" method="POST">
    <input name="name" placeholder="Enter a new document name" type="text"></input>
    <input type="submit"></input>
</form>
</body>
</html>
